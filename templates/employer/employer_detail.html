{% extends "base.html" %}

{% block title %}{{ employer }} - Роботодавець{% endblock %}

{% block content %}
<nav aria-label="breadcrumb" class="mb-4">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="{% url 'employer:list' %}" class="text-decoration-none">Роботодавці</a></li>
    <li class="breadcrumb-item active" aria-current="page">{{ employer }}</li>
  </ol>
</nav>

<div class="row g-4">
  <!-- Sidebar: Company Info -->
  <div class="col-lg-4">
    <div class="card border-0 shadow-sm sticky-top" style="top: 2rem; z-index: 10;">
      <div class="card-body text-center py-4">
        <!-- Logo -->
        <div class="mb-4 shadow-sm d-inline-block p-1 bg-white rounded" style="width: 120px; height: 120px;">
          {% if employer.logo %}
          <img src="{{ employer.logo.url }}" alt="{{ employer }}" class="rounded img-fluid"
            style="width: 100%; height: 100%; object-fit: contain;">
          {% else %}
          <div class="bg-light rounded d-flex align-items-center justify-content-center w-100 h-100">
            <i class="bi bi-building fs-1 text-secondary"></i>
          </div>
          {% endif %}
        </div>

        <h1 class="h3 fw-bold mb-2">{{ employer }}</h1>

        {% if employer.brand_name %}
        <p class="text-muted small mb-3">Бренд: {{ employer.brand_name }}</p>
        {% endif %}

        <div class="d-flex flex-wrap justify-content-center gap-2 mb-4">
          <span class="badge bg-primary-subtle text-primary border border-primary-subtle px-3 py-2">
            <i class="bi bi-geo-alt me-1"></i>
            {{ employer.location.name }}, {{ employer.location.community.district.region.name }} обл.
          </span>
          {% if employer.kved %}
          <span class="badge bg-info-subtle text-dark border border-info-subtle px-3 py-2 text-wrap"
            style="max-width: 100%;">
            <i class="bi bi-activity me-1"></i>КВЕД: {{ employer.kved.code }}
          </span>
          {% endif %}
        </div>

        <hr class="my-4 opacity-10">

        <div class="text-start px-3">
          {% if employer.website %}
          <div class="mb-3">
            <label class="small text-muted d-block mb-1">Сайт</label>
            <a href="{{ employer.website }}" target="_blank" class="text-decoration-none">
              <i class="bi bi-globe2 me-2"></i>{{ employer.website|truncatechars:35 }}
            </a>
          </div>
          {% endif %}

          {% if employer.tax_id %}
          <div class="mb-3">
            <label class="small text-muted d-block mb-1">ЄДРПОУ / РНОКПП</label>
            <span class="fw-medium">{{ employer.tax_id }}</span>
          </div>
          {% endif %}

          {% if employer.address %}
          <div class="mb-3">
            <label class="small text-muted d-block mb-1">Адреса офісу</label>
            <span class="small">{{ employer.address }}</span>
          </div>
          {% endif %}
        </div>
      </div>
    </div>
  </div>

  <!-- Main Content: Description & Vacancies -->
  <div class="col-lg-8">
    <div class="card border-0 shadow-sm mb-4">
      <div class="card-body p-4">
        <h4 class="fw-bold mb-4">Про компанію</h4>
        <div class="company-description text-muted" style="line-height: 1.7;">
          {% if employer.description %}
          {{ employer.description|linebreaks }}
          {% else %}
          <p>Опис компанії поки що відсутній.</p>
          {% endif %}
        </div>
      </div>
    </div>

    <div class="d-flex align-items-center justify-content-between mb-4 mt-5">
      <h4 class="fw-bold mb-0">
        Вакансії роботодавця
        {% if total_vacs %}
        <span class="badge bg-secondary ms-2">{{ total_vacs }}</span>
        {% endif %}
      </h4>
    </div>

    {% if vacancies %}
    <div class="row g-3">
      {% for vacancy in vacancies %}
      <div class="col-12">
        <div class="card h-100 border-0 shadow-sm hover-shadow-lg transition-all" style="transition: all 0.3s ease;">
          <div class="card-body p-4">
            <div class="d-flex justify-content-between align-items-start">
              <div>
                <h5 class="fw-bold mb-1">
                  <a href="{% url 'vacancy:detail' vacancy.pk %}" class="text-decoration-none text-dark">
                    {{ vacancy.title }}
                  </a>
                </h5>
                <div class="d-flex flex-wrap gap-3 text-muted small mt-2">
                  <span><i class="bi bi-geo-alt me-1"></i>{{ vacancy.location.name }}</span>
                  {% if vacancy.salary_min or vacancy.salary_max %}
                  <span class="text-success fw-bold">
                    <i class="bi bi-cash-stack me-1"></i>
                    {% if vacancy.salary_min %}від {{ vacancy.salary_min }}{% endif %}
                    {% if vacancy.salary_max %} до {{ vacancy.salary_max }}{% endif %} грн
                  </span>
                  {% endif %}
                  <span><i class="bi bi-clock me-1"></i>{{ vacancy.published_at|date:"d.m.Y" }}</span>
                </div>
              </div>
              <a href="{% url 'vacancy:detail' vacancy.pk %}"
                class="btn btn-primary btn-sm px-4 rounded-pill">Детальніше</a>
            </div>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>

    <!-- Pagination -->
    <div class="mt-4">
      {% include "includes/pagination.html" %}
    </div>
    {% else %}
    <div class="card border-0 shadow-sm bg-light">
      <div class="card-body py-5 text-center">
        <i class="bi bi-clipboard-x fs-1 text-muted mb-3 d-block"></i>
        <p class="text-muted mb-0">На даний момент актуальних вакансій немає.</p>
      </div>
    </div>
    {% endif %}
  </div>
</div>
{% endblock %}